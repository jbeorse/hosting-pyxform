<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
	<meta charset="UTF-8" />
    <title>Open Data Kit  &raquo; XLS2Xform Tutorial</title>
	<link rel="stylesheet" type="text/css" media="all" href="http://opendatakit.org/wp-content/themes/odksite2/style.css" />
	<link href="http://opendatakit.org/wp-content/themes/odksite2/prettify/prettify.css" type="text/css" rel="stylesheet" />
	<link rel="pingback" href="http://opendatakit.org/xmlrpc.php" />
	<script type="text/javascript" src="http://opendatakit.org/wp-content/themes/odksite2/prettify/prettify.js"></script>

	<link rel="alternate" type="application/rss+xml" title="Open Data Kit &raquo; Feed" href="http://opendatakit.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Open Data Kit &raquo; Comments Feed" href="http://opendatakit.org/comments/feed/" />
				
	<script type="text/javascript">//<![CDATA[
	// Google Analytics for WordPress by Yoast v4.1 | http://yoast.com/wordpress/google-analytics/
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount','UA-19376020-1']);
	_gaq.push(['_trackPageview'],['_trackPageLoadTime']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
	//]]></script>
<link rel="alternate" type="application/rss+xml" title="Open Data Kit &raquo; Build Comments Feed" href="http://opendatakit.org/use/build/feed/" />
<script type='text/javascript' src='http://opendatakit.org/wp-includes/js/l10n.js?ver=20101110'></script>
<script type='text/javascript' src='http://opendatakit.org/wp-includes/js/jquery/jquery.js?ver=1.4.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://opendatakit.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://opendatakit.org/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Open Data Kit' href='http://opendatakit.org/' />
<link rel='up' title='Use' href='http://opendatakit.org/use/' />
<link rel='prev' title='Use' href='http://opendatakit.org/use/' />
<link rel='next' title='Deployments' href='http://opendatakit.org/about/deployments/' />

<meta name="generator" content="WordPress 3.1.2" />
<link rel='canonical' href='http://opendatakit.org/use/build/' />
  </head>
  <body onload="prettyPrint()">
    <div class="main">
	  <div id="header">
		<div id="logo">
		  <h1><a href="/"><img src="http://opendatakit.org/wp-content/themes/odksite2/images/logo.png" /></a></h1>
	    </div>
	    <ul class="navigation">

	      <li><a href="/about/">About</a></li>
	      <li><a href="/use/">Use</a></li>
	      <li><a href="/participate/">Participate</a></li>
	    </ul>
	  </div>
	  <div class="seperator">&nbsp;</div>


      <div class="content clearfix">
        <div class="left wide">
                      
        	          	    
    					<div class="post-20 page type-page status-publish hentry" id="post-20">
            		<h2 class="title">XLS2Xform Tutorial</h2>
            		<div class="entry">
            		    <p>XLS2XForm is a tool to simplify the creation of forms. Forms can be designed with Excel and XLS2XForm will convert it to a XForm that can be used with ODK tools.</p>
            		    <p>This tutorial teaches you to build your forms using excel. Please refer to the <a href="/static/example.xls">example excel file</a> as you read through the tutorial.</p>

<h3>Basic format</h3>
    <p>Each workbook must have two worksheets: survey and choices.</p> 
    <ul>
        <li>The survey worksheet contains the structure and most of the content of the form. It contains the full list of questions and information about how they should be presented. Most rows represent a question; the rest of the rows specify control structures such as groups.</li>
        <li>The choices worksheet is used to specify the options for multiple choice questions. Each row represents a multiple choice option.</li>
    </ul>
    <p>Each of these worksheets has a set of necessary columns that must be present for the .xls file to be valid. Additionally, each worksheet has a set of optional columns that allow further control over the behavior of each entry in the form, but are not essential to the specification. Every entry must have values for each necessary column, but any of the optional columns may be left blank from entry to entry. For example, in the survey worksheet, each question must have a name specified, but one question may have a numerical constraint specified while another has an image file and a third may have niether. These columns, necessary or optional, may appear in any order. Optional columns may be left out completely. Any number of rows may be left blank.</p>
<h3>Survey Worksheet</h3>
    <p>The rows of the survey worksheet specify the structure of the form. Questions will appear in the order they are specified. The various question types correspond to Collect question types:</p>
    <ul>
        <li><b>text</b>: A string reponse</li>
        <li><b>integer</b>: A whole number response</li>
        <li><b>decimal</b>: Any number response</li>
        <li><b>date</b>: A date response</li>
        <li><b>photo</b>: Opens the camera app and captures a photo response</li>
        <li><b>select all that apply</b>: A multiple choice question where multiple answers are allowed. The list name of the set of choices must also be provided. An example of a tag entry for select would be: "select all that apply from colors", where "colors" is a set of choices in the choices from the choices worksheet.</li>
        <li><b>select one</b>: A multiple choice question where only one answer is allowed. It requires a list name for a set of choices just as select does.</li>
        <li><b>barcode</b>: Opens a barcode scanning app and captures a barcode response</li>
        <li><b>gps</b>: Enables the phone's gps and caputures a gps location response</li>
    </ul>
    <p>There are also question types that use the above types and set a few parameters for you:</p>
    <ul>
        <li><b>note</b>: A question that requires no response. It is used to write messages in the form. For example, you might describe the following section or provide instructions.</li>
        <li><b>phone number</b>: A string reponse the forces the reponse to only use characters valid in a phone number</li>
        <li><b>number of days in last month/year</b>: An integer response that constrains the value between 0-31 or 0 and 365 respectively.</li>
    </ul>
    <p>There are also question types that load information from the phone without displaying a question to the user:</p>
    <ul>
        <li><b>imei</b>: The device id</li>
        <li><b>start time</b>: A time stamp indicating when the survey was started</li>
        <li><b>end time</b>: A time stamp indicating when the survey was finished</li>
    </ul>
    <p>Questions can also be grouped or repeated. To begin a group, under the tag column enter "begin group". After all the questions desired are included, under the tag column enter "end group". Note that the "begin group" row must have values for all three necessary columns (specified below), but the "end group" row does not. To make a set of questions repeat, enter "begin repeat" instead.</p>
    <p>The three necessary columns are type, name, and label.</p>
    <ul>
        <li>The <b>type</b> column specifies the question type. A few examples include text, integer, and select one. The type column can also specify the begin and end of groups or repeat sections.</li>
        <li>The <b>name</b> column specifies the internal name of the question or group. When referring to a question somewhere else in the form, this is the name to use. When viewing completed data from Aggregate, this name will be used. This value must be unique and not contain any spaces. It may contain numbers and some special characters, but must start with a letter.</li>
        <li>The <b>label</b> column specifies the label text the user sees in the form. For a question this will be the question text. For a group this will be the group label that appears in the breadcrumb trail.</li>
    </ul>
    <p>The following columns are optional. Some of them have a bind, media, or translation label. The bind label refers to columns that specify rules the questions must follow. The media label refers to columns that specify attached media. The translation label refers to translations of other columns.</p>
    <ul>
        <li>The <b>hint</b> column specifies the question's hint, which will appear smaller and less emphasized than the question's label. A common use for the hint column is to describe the question's constraints.</li>
        <li>The <b>bind:constraint</b> column specifies constraints on the responses that can be provided for questions. For a numerical question this will be a numerical constraint, such as "0 <= . and . <= 100". The dot represents the value provided by the user; the example constraint specifies that the question must have a response between 0 and 100. Note that logical operators "and", "or", and "not" are accepted. For a string question, this column's value will be a regular expression, such as "regex(., '^\d*$')". This example could be used to specify valid input for a phone number.</li>
        <li>The <b>bind:relevant</b> column specifies whether a question shoud be asked or not based on the answer to a previous question. For example, if a medical form has a section about gynecological information, it could have a question that asks the users gender. It would then only display the gynecological section if that response is female. To do this, for each question in the gynecological section, the bind:relevant column would contain "${gender}='female'" where gender is the name of the question (not the label) and female is the desired value. Numerical constraints and logical operators can also be used: "${gender}='female' and ${age_in_years}>=15 and ${age_in_years}<=49"</li>
        <li>The <b>bind:required</b> column specifies whether a response to the question is required. If "true()" then the user cannot advance to the next question without providing a response. If "false()" then the user does not need to provide a response. By default all questions are required.</li>
        <li>The <b>media:images</b> column specifies an image to attach to the question. Similarly, <b>media:audio</b> specifies an audio file to attach. Note that the media file must be present within the phone's sdcard in the correct location.</li>
        <li>The <b>translation:&ltlanguage&gt</b> column specifies a translation of the label column into &ltlanguage&gt. A new instance of this column can be created for each translation language. For example, a question with label value "Good Day" might have translation:Spanish value "Buenos Dias" and tranlsation:German value "Guten Tag".</li>
        <li> The <b>translation:images:&ltlangauge&gt</b> column specifies a translation of the media:images column value. This method can be used to translate media:audio as well.</li>
    </ul>
<h3>Choices Worksheet</h3>
    <p>The rows of the choices worksheet specify the multiple choice options for the "select all that apply" and "select one" questions. Every multiple choice question must reference a list name specified here. Furthermore, each set of choices is reusable; multiple questions could reference the same list name. For example, a "yes_no" list with choices "yes" and "no" would likely be used many times.</p>
    <p>The three necessary columns are list name, name, and label.</p>
    <ul>
        <li>The <b>list name</b> column specifies the name of the set of multiple choice responses. For example, set of choices "brown", "blue", "orange", "red" might share the list name "colors". Note that each choice in your set of choices will have the same list name.</li>
        <li>The <b>name</b> column specifies the internal name for the choice (much like the name column from the survey worksheet). This value must be unique and not contain any spaces. It may contain numbers and some special characters, but must start with a letter.</li>
        <li>The <b>label</b> column specifies the text the user sees for the choices.</li>
    </ul>
    <p>The choices worksheet may also use the media and translation columns just as they are used in the survey worksheet.</p>

            		</div>
            		<p class="postmetadata"></p>
            	</div>  
        </div>

        <div class="right narrow">
        <ul class="sidebar">
  <li id="subpages">
  <h2 class="widgettitle">Navigate</h2>

  <p><a href="http://opendatakit.org/use/">&laquo; back to Use</a></p>  <ul>  
  <li class="page_item page-item-20 current_page_item"><a href="http://opendatakit.org/use/build/" title="Build">Build</a></li>
<li class="page_item page-item-8"><a href="http://opendatakit.org/use/collect/" title="Collect">Collect</a></li>
<li class="page_item page-item-10"><a href="http://opendatakit.org/use/aggregate/" title="Aggregate">Aggregate</a></li>
<li class="page_item page-item-44"><a href="http://opendatakit.org/use/validate/" title="Validate">Validate</a></li>
<li class="page_item page-item-44"><a href="http://xls2xform.opendatakit.org/" title="XLS2Xform">XLS2Xform</a></li>
  </ul>
  </li>

</ul>
</div>
        
      </div>
    </div>

    <div class="footer clearfix">
      <a href="/" class="footerLogo">Open Data Kit</a>
      <dl>
        <dt><a href="/about/">About</dt>

        <dd>
          <ul>
	        <!-- <li><a href="/about/">Overview</a></li> -->
            <li class="page_item page-item-604"><a href="http://opendatakit.org/about/tools/" title="Tools">Tools</a></li>
<li class="page_item page-item-27"><a href="http://opendatakit.org/about/deployments/" title="Deployments">Deployments</a></li>
<li class="page_item page-item-216"><a href="http://opendatakit.org/about/research/" title="Research">Research</a></li>
<li class="page_item page-item-366"><a href="http://opendatakit.org/about/press/" title="Press">Press</a></li>
<li class="page_item page-item-388"><a href="http://opendatakit.org/about/team/" title="Team">Team</a></li>

<li class="page_item page-item-159"><a href="http://opendatakit.org/about/contact/" title="Contact">Contact</a></li>
            <li><a href="/blog/">Blog</a></li>
          </ul>
        </dd>
        <dt><a href="/use/">Use</a></dt>
        <dd>
          <ul>
            <!-- <li><a href="/use/">Overview</a></li> -->

            <li class="page_item page-item-20 current_page_item"><a href="http://opendatakit.org/use/build/" title="Build">Build</a></li>
<li class="page_item page-item-8"><a href="http://opendatakit.org/use/collect/" title="Collect">Collect</a></li>
<li class="page_item page-item-10"><a href="http://opendatakit.org/use/aggregate/" title="Aggregate">Aggregate</a></li>
<li class="page_item page-item-44"><a href="http://opendatakit.org/use/validate/" title="Validate">Validate</a></li>
<li class="page_item page-item-44"><a href="http://xls2xform.opendatakit.org/" title="XLS2Xform">XLS2Xform</a></li>
          </ul>
        </dd>
        <dt><a href="/participate/">Participate</a></dt>
        <dd>

          <ul>
	        <!-- <li><a href="/participate/">Overview</a></li> -->
            <li><a href="http://code.google.com/p/opendatakit">Code</a></li>
            <li class="page_item page-item-977"><a href="http://opendatakit.org/participate/donate/" title="Donate">Donate</a></li>
            <!-- <li><a href="http://change.washington.edu">UW Change</a></li>
			<li><a href="http://www.openrosa.org/">OpenRosa</a></li> -->
          </ul>
        </dd>
      </dl>

    </div>
	  </body>
</html>

<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Minified using disk
Page Caching using disk (enhanced)

Served from: opendatakit.org @ 2011-06-17 21:42:42 -->
